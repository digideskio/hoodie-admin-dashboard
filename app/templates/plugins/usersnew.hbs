<div class="internalPlugin">
  <div class="container">
    <h1>New Ember Users Plugin</h1>

    {{add-user action='updateUserList'}}

    <h2>Search for users</h2>
    <form class="userSearch" {{action 'search' on="submit"}}>
      <fieldset>
        <div class="group">
          <label for="">Search term</label>
          {{input value=searchTerm type="text" class="form-control search-query" placeholder="Username"}}
          <p class="help-block">Search only applies to usernames.</p>
          <button class="submit btn ok" type="submit">Search</button>
          {{#if searchTerm}}
          <button class="btn clearSearch" {{action 'clearSearch'}}>Clear search</button>
          {{/if}}
        </div>
      </fieldset>
    </form>

    <h2>Your users</h2>
    <div class="content centered">
      <div class="tableStatus">
        <p class="currentSearchMetrics muted">Showing <strong>{{model.users.length}}</strong> {{pluralize-word model.users.length 'user'}} {{#if activeSearch}} matching <strong>{{activeSearch}}</strong> {{/if}}out of a total of <strong>{{model.totalUsers}}</strong>.</p>
      </div>
      {{#if model.users}}

      Page number: {{pageNumber}}

      {{#if skipFactor}}
      <button class="btn previous" {{action 'previous'}}>Previous</button>
      {{/if}}
      {{#unless isLastPage}}
      <button class="btn next" {{action 'next'}}>Next</button>
      {{/unless}}
      <table id="userList" class="table users table-striped">
        <thead class="{{if sortDesc 'desc' 'asc'}}">
          <tr>
            <th {{action 'sortBy' 'name'}} class="{{is-active-table-header 'name' sortBy}}">Username</th>
            <th {{action 'sortBy' 'created-at'}} class="{{is-active-table-header 'created-at' sortBy}}">Signup date</th>
            <th data-sort-by="state" {{action 'sortBy' 'state'}}>State</th>
            <th class="no-sort"></th>
          </tr>
        </thead>
        <tbody>
          {{#each model.users as |user|}}
          <tr data-id="{{user.value.id}}" class="user">
            <td>{{user.value.name}}</td>
            <td data-sort="{{convert-ISO-to-timestamp user.value.createdAt}}" class="timeago" title="{{user.value.createdAt}}">{{time-ago-in-words user.value.createdAt}}</td>
            <td><span class="pill">{{user.value.state}}</span></td>
            <td class="no-sort">
              <a href="#user/{{user.id}}" class="edit">edit</a> /
              <a href="#" class="removeUserPrompt">delete</a> /
              <a href="{{link-to-futon-user user.name}}">futon</a>
            </td>
          </tr>
          {{/each}}
        </tbody>
      </table>
      {{else}}
        {{#if activeSearch}}
          <span class="alert alert-warning">No results for <strong>{{activeSearch}}</strong>. Please note that the search only matches exact strings from the first character onwards at the moment.</span>
        {{else}}
          <span>You don't have any users yet.</span>
        {{/if}}
      {{/if}}
    </div>
  </div>
</div>